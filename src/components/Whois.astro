---
import whois from "whois";

interface Props {
  domain: string;
}

const { domain } = Astro.props;

let error = true;

const result = await new Promise<string>((res, rej) => {
  whois.lookup(domain, (err, data) => {
    if (err) {
      rej(err);
    }
    res(data);
  });
}).catch(() => {
  error = true;
  return "";
});

const whoisData = result.toString().trim();
---

<div class="flex flex-col justify-center items-center w-full">
  <div class="w-10/12 sm:w-6/12 py-16 flex flex-col gap-4">
    <a href="/">
      <div class="text-gray-400">Go back</div>
    </a>

    <div class="text-2xl">
      {domain}
    </div>

    <div class="font-mono break-words whitespace-pre-wrap">
      {error ? "Looks like something went wrong..." : whoisData}
    </div>
  </div>
</div>
